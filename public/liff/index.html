<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <title>LIFF App</title>
  <!-- LIFF SDK CDN https://developers.line.biz/en/docs/liff/developing-liff-apps/#specify-cdn-path -->
  <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/versions/2.27.2/sdk.js"></script>
</head>

<body>
  <h1>LIFF App 測試頁面</h1>
  <button id="btnProfile">取得用戶資訊</button>
  <pre id="profileResult"></pre>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      try {
        // ✅ 初始化 LIFF
        await liff.init({
          liffId: "2008306291-9wMKw2Mr"
        });

        // ✅ 若尚未登入則導向登入
        if (!liff.isLoggedIn()) {
          liff.login({
            redirectUri: window.location.href
          });
          return;
        }

        console.log("LIFF 初始化完成");

        // ✅ 綁定按鈕事件
        document.getElementById("btnProfile").addEventListener("click", async () => {
          const profile = await liff.getProfile();
          document.getElementById("profileResult").textContent = JSON.stringify(profile, null, 2);
          
          console.log(liff.getAppLanguage());
          console.log(liff.getVersion());
          console.log(liff.isInClient());
          console.log(liff.isLoggedIn());
          console.log(liff.getOS());
          console.log(liff.getLineVersion());
        });

      } catch (err) {
        console.error("LIFF 初始化失敗:", err);
        document.body.innerHTML += `<p style="color:red;">初始化錯誤，請檢查 liffId 或 https 設定。</p>`;
      }
    });
  </script>
</body>

</html>