# 開發規範條列式規格

## 1. 開發環境

### 1.1 基礎環境配置
- **作業系統**：macOS / Windows 11
- **套件管理**：使用官方套件管理器（npm）
- **環境變數**：使用 `.env` 檔案管理，不提交敏感資訊到版控

### 1.2 開發工具標準
- **IDE/編輯器**：Visual Studio Code
- **版本控制**：Git + GitHub
- **程式碼格式化**：Prettier + ESLint（自動化執行）

### 1.3 技術棧
- **語言**：Node.js 22.12.0
- **框架**：Express 4.21.2
- **套件**：
  - got: 14.4.7
  - jsonwebtoken: 9.0.2

### 1.4 環境管理
- **開發環境**：本機 + Docker Compose
- **測試環境**：與正式環境相同配置
- **正式環境**：容器化部署（Kubernetes/Docker Swarm）
- **CI/CD**：GitHub Actions / GitLab CI 自動化流程

---

## 2. FP 開發方式

### 2.1 純函數原則
- **無副作用**：函數不修改外部狀態
- **參考透明性**：相同輸入必定產生相同輸出
- **可預測性**：函數行為完全由參數決定
- **可測試性**：易於編寫單元測試

### 2.2 不可變性實踐
- **資料不可變**：使用 `const` 宣告，避免直接修改物件
- **深拷貝操作**：使用 spread operator 或專用函式庫
- **狀態管理**：採用 Redux/Zustand 等不可變狀態管理
- **陣列操作**：優先使用 `map`、`filter`、`reduce`

### 2.3 函數組合模式
- **高階函數**：函數作為參數或回傳值
- **函數合成**：將簡單函數組合成複雜功能
- **柯里化**：將多參數函數轉換為單參數函數鏈
- **管道運算**：使用 pipe/compose 提升可讀性

### 2.4 錯誤處理策略
- **Either/Maybe 模式**：使用函數式錯誤處理
- **避免例外**：優先回傳錯誤值而非拋出例外
- **鏈式安全**：使用 optional chaining 防止 null/undefined
- **失敗快速**：早期發現並處理錯誤

---

## 3. JavaScript 程式碼撰寫風格

### 3.1 變數宣告
- **優先使用 `const`**：不重新賦值的變數
- **次選 `let`**：需要重新賦值的變數
- **禁用 `var`**：避免函數作用域混淆
- **一行一變數**：禁止多變數同行宣告

### 3.2 命名規範
- **camelCase**：變數、函數名稱（例：`getUserData`）
- **PascalCase**：類別、建構函數（例：`UserService`）
- **UPPER_SNAKE_CASE**：常數（例：`API_BASE_URL`）
- **語意化命名**：名稱須清楚表達用途和功能

### 3.3 函數撰寫
- **箭頭函數**：優先使用 `() =>` 語法
- **單一職責**：每個函數只負責一項任務
- **參數解構**：使用解構賦值簡化參數傳遞
- **預設參數**：為參數提供合理預設值

### 3.4 物件與陣列
- **字面量語法**：使用 `[]` 和 `{}` 創建陣列物件
- **解構賦值**：簡化屬性存取和參數傳遞
- **展開運算子**：使用 `...` 進行淺拷貝操作
- **簡寫語法**：屬性名稱與變數名稱相同時使用簡寫

### 3.5 程式碼格式
- **縮排**：使用 2 個空格縮排
- **行長限制**：每行最多 80-120 字元
- **分號**：統一使用分號結尾
- **引號**：統一使用單引號 `'`，模板字串使用反引號

### 3.6 註解與文件
- **JSDoc 格式**：函數和類別使用標準 JSDoc
- **行內註解**：解釋複雜邏輯的必要說明
- **TODO 標記**：標注待完成或待優化項目
- **避免廢話註解**：不寫顯而易見的註解

---

## 4. TDD 測試

### 4.1 測試驅動循環
- **紅燈階段**：先寫失敗的測試案例
- **綠燈階段**：寫最少程式碼使測試通過
- **重構階段**：優化程式碼結構和品質
- **小步迭代**：每次只專注一個小功能

### 4.2 測試案例設計
- **原子化測試**：每個測試只驗證一個行為
- **獨立性**：測試間不相互依賴
- **可重複執行**：任何時候執行結果都一致
- **明確斷言**：使用具體、明確的判斷條件

### 4.3 測試結構
- **AAA 模式**：Arrange（準備）、Act（執行）、Assert（驗證）
- **描述性命名**：測試名稱清楚描述測試情境
- **測試分組**：使用 `describe` 和 `it` 組織測試
- **測試覆蓋率**：維持 80% 以上程式碼覆蓋率

### 4.4 測試類型
- **單元測試**：測試個別函數和類別
- **整合測試**：測試模組間的互動
- **端對端測試**：測試完整使用者流程
- **快照測試**：驗證 UI 元件渲染結果